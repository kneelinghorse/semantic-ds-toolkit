pack: "common.identity"
version: "0.1.0"
description: "Common identity concepts for person, organization, and entity identification"
depends_on: ["common.units>=0.1.0"]
concepts:
  - cid: identity.person
    labels: ["customer_id", "user_id", "person_pk", "person_id", "member_id", "client_id", "individual_id"]
    description: "Unique identifier for a person or individual"
    facets:
      pii: true
      identifier: true
      categorical: false
      numerical: false
    inference:
      rules:
        - condition: "patterns && patterns.some(p => /customer|user|person|member|client|individual/.test(p))"
          action: "suggest_identity_person"
          confidence: 0.85
        - condition: "facets && facets.identifier && labels.some(l => /id$|_id$/.test(l))"
          action: "suggest_identity_person"
          confidence: 0.75
    examples: ["user123", "customer_456", "person_789"]

  - cid: identity.organization
    labels: ["company_id", "org_id", "organization_id", "corp_id", "enterprise_id", "business_id"]
    description: "Unique identifier for an organization or company"
    facets:
      pii: false
      identifier: true
      categorical: false
      numerical: false
    inference:
      rules:
        - condition: "patterns && patterns.some(p => /company|org|corp|enterprise|business/.test(p))"
          action: "suggest_identity_organization"
          confidence: 0.9
    examples: ["acme_corp", "org_456", "company_123"]

  - cid: identity.account
    labels: ["account_id", "account_number", "account_pk", "acc_id", "account_ref"]
    description: "Account identifier linking to financial or service accounts"
    facets:
      pii: true
      identifier: true
      categorical: false
      numerical: false
    inference:
      rules:
        - condition: "patterns && patterns.some(p => /account/.test(p))"
          action: "suggest_identity_account"
          confidence: 0.95
    examples: ["acc_123456", "account_789", "12345678"]

  - cid: identity.email
    labels: ["email", "email_address", "user_email", "contact_email", "email_addr"]
    description: "Email address as personal identifier"
    facets:
      pii: true
      identifier: true
      categorical: false
      numerical: false
    inference:
      rules:
        - condition: "patterns && patterns.some(p => /@/.test(p))"
          action: "suggest_identity_email"
          confidence: 0.98
        - condition: "sample_values && sample_values.some(v => /@/.test(v))"
          action: "suggest_identity_email"
          confidence: 0.99
    examples: ["john@example.com", "user@domain.org", "contact@company.co"]

  - cid: identity.phone
    labels: ["phone", "phone_number", "mobile", "contact_number", "telephone", "cell_phone"]
    description: "Phone number as contact identifier"
    facets:
      pii: true
      identifier: true
      categorical: false
      numerical: true
    inference:
      rules:
        - condition: "patterns && patterns.some(p => /phone|mobile|tel/.test(p))"
          action: "suggest_identity_phone"
          confidence: 0.85
        - condition: "sample_values && sample_values.some(v => /^[\\d\\-\\(\\)\\+\\s]+$/.test(v))"
          action: "suggest_identity_phone"
          confidence: 0.8
    examples: ["+1-555-0123", "(555) 123-4567", "555.123.4567"]

  - cid: identity.username
    labels: ["username", "login", "user_name", "handle", "alias", "screen_name"]
    description: "Username or handle for system access"
    facets:
      pii: true
      identifier: true
      categorical: false
      numerical: false
    inference:
      rules:
        - condition: "patterns && patterns.some(p => /username|login|handle|alias/.test(p))"
          action: "suggest_identity_username"
          confidence: 0.9
    examples: ["johndoe", "user123", "admin_user"]

  - cid: identity.session
    labels: ["session_id", "session_token", "session_key", "sess_id", "session_ref"]
    description: "Session identifier for tracking user sessions"
    facets:
      pii: false
      identifier: true
      categorical: false
      numerical: false
      temporal: true
    inference:
      rules:
        - condition: "patterns && patterns.some(p => /session/.test(p))"
          action: "suggest_identity_session"
          confidence: 0.95
    examples: ["sess_abc123", "session_456def", "sk_789ghi"]

  - cid: identity.device
    labels: ["device_id", "device_uuid", "hardware_id", "machine_id", "device_token"]
    description: "Device or hardware identifier"
    facets:
      pii: false
      identifier: true
      categorical: false
      numerical: false
    inference:
      rules:
        - condition: "patterns && patterns.some(p => /device|hardware|machine/.test(p))"
          action: "suggest_identity_device"
          confidence: 0.9
    examples: ["device_abc123", "hw_456789", "uuid_def456"]

  - cid: identity.ip.address
    labels: ["ip_address", "ip", "client_ip", "remote_ip", "source_ip"]
    description: "IP address for network identification"
    facets:
      pii: true
      identifier: true
      categorical: false
      numerical: false
    inference:
      rules:
        - condition: "patterns && patterns.some(p => /ip/.test(p))"
          action: "suggest_identity_ip"
          confidence: 0.9
        - condition: "sample_values && sample_values.some(v => /^\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}$/.test(v))"
          action: "suggest_identity_ip"
          confidence: 0.95
    examples: ["192.168.1.1", "10.0.0.1", "172.16.0.1"]

  - cid: identity.transaction
    labels: ["transaction_id", "txn_id", "trans_id", "payment_id", "order_id"]
    description: "Transaction or order identifier"
    facets:
      pii: false
      identifier: true
      categorical: false
      numerical: false
    inference:
      rules:
        - condition: "patterns && patterns.some(p => /transaction|txn|trans|payment|order/.test(p))"
          action: "suggest_identity_transaction"
          confidence: 0.9
    examples: ["txn_abc123", "order_456789", "pay_def456"]

  - cid: identity.api.key
    labels: ["api_key", "access_token", "auth_token", "bearer_token", "client_secret"]
    description: "API authentication key or token"
    facets:
      pii: false
      identifier: true
      categorical: false
      numerical: false
    inference:
      rules:
        - condition: "patterns && patterns.some(p => /api|token|key|secret/.test(p))"
          action: "suggest_identity_api_key"
          confidence: 0.85
    examples: ["sk_live_abc123", "token_456def", "api_789ghi"]

  - cid: identity.reference
    labels: ["reference_id", "ref_id", "reference_number", "ref_num", "tracking_id"]
    description: "General reference identifier for tracking purposes"
    facets:
      pii: false
      identifier: true
      categorical: false
      numerical: false
    inference:
      rules:
        - condition: "patterns && patterns.some(p => /reference|ref|tracking/.test(p))"
          action: "suggest_identity_reference"
          confidence: 0.8
    examples: ["ref_123456", "tracking_abc789", "reference_def456"]